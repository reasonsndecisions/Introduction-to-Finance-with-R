## ----message=F,warning=F----------------------------------------------------------------------------------
library(tidyverse) 



## ----message=FALSE, warning=FALSE-------------------------------------------------------------------------

df1 <- read_csv(file="oes2017.csv")



## ----message=FALSE, warning=FALSE-------------------------------------------------------------------------
# Your code



## ----echo=FALSE, include=FALSE----------------------------------------------------------------------------

df2 <- read_csv(file = "indices.csv")



## ---------------------------------------------------------------------------------------------------------

view(df1)




## ---------------------------------------------------------------------------------------------------------
# Your code


## ---------------------------------------------------------------------------------------------------------

dim(df1)

df1 <- df1 %>% 
  select(NAICS,OCC_CODE,OCC_TITLE,
         OCC_GROUP, TOT_EMP, PCT_TOTAL, H_MEAN)




## ---------------------------------------------------------------------------------------------------------
# Your code



## ----echo=FALSE, include=FALSE----------------------------------------------------------------------------

df2 <- df2 %>%
  select(date, GSPC, N100)



## ---------------------------------------------------------------------------------------------------------

df1 <- df1 %>% 
  filter(H_MEAN != "#" & H_MEAN != "*")



## ---------------------------------------------------------------------------------------------------------
# Hint: First check the structure of the df2 using str() function.
# You will need to put date variable in quotations. 
# For example "2020-03-01".

# Your code




## ----echo=FALSE, include=FALSE----------------------------------------------------------------------------

df2 <- df2 %>%
  filter(date >= "2007-01-01")



## ---------------------------------------------------------------------------------------------------------

df1 <- df1 %>% 
  rename(H_WAGE_MEAN = H_MEAN)




## ---------------------------------------------------------------------------------------------------------
# Your code



## ----echo=FALSE, include=FALSE----------------------------------------------------------------------------

df2 <- df2 %>%
  rename(EuroNext = N100, 
         SP500 = GSPC)



## ---------------------------------------------------------------------------------------------------------
str(df1)


## ---------------------------------------------------------------------------------------------------------


# Note how we have as.numeric() within log().

df1 <- df1 %>% 
  mutate(log_wage = log(as.numeric(H_WAGE_MEAN)),
                    TOT_EMP = as.numeric(TOT_EMP),
                    PCT_TOTAL = as.numeric(PCT_TOTAL))


## ---------------------------------------------------------------------------------------------------------
# Your code



## ----echo=FALSE, include=FALSE----------------------------------------------------------------------------

df2 <- df2 %>%
  mutate(RtEuro = log(EuroNext/lag(EuroNext)),
         RtSP500 = log(SP500/lag(SP500)))



## ---------------------------------------------------------------------------------------------------------
any(is.na(df1))

df1 <- df1 %>% 
  drop_na()


## ---------------------------------------------------------------------------------------------------------
any(is.na(df1))


## ----echo=FALSE, include=FALSE----------------------------------------------------------------------------

df2 <- df2 %>%
  drop_na()



## ---------------------------------------------------------------------------------------------------------
df1 <- df1 %>%
  mutate(NAICS2 = substr(NAICS, start = 1, stop = 2))


## ---------------------------------------------------------------------------------------------------------
# Your code





## ----echo=FALSE, include=FALSE----------------------------------------------------------------------------

df2 <- df2 %>%
  mutate(year = substr(date, start = 1, stop = 4))



## ---------------------------------------------------------------------------------------------------------

df1_grouped <- df1 %>% 
  select(NAICS, H_WAGE_MEAN) %>% 
  group_by(NAICS) %>% 
  summarise(grouped_mean = mean(as.numeric(H_WAGE_MEAN))) %>% 
  ungroup()

# Note our use of as.numeric() - Why?



## ---------------------------------------------------------------------------------------------------------
# Your code

  



## ----echo=FALSE, include=FALSE----------------------------------------------------------------------------

df2 <- df2[,c(1:6)]

df2_year <- df2 %>%
  group_by(year) %>%
  summarise(avgRt500 = mean(RtSP500),
         avgRtEuro = mean(RtEuro)) %>%
  ungroup()


plot(df2_year$avgRt500, df2_year$avgRtEuro)


## ---------------------------------------------------------------------------------------------------------
saveRDS(df1, file = "df1.rds")


## ---------------------------------------------------------------------------------------------------------

# Your code



## ---------------------------------------------------------------------------------------------------------
rm(list = ls())


## ---------------------------------------------------------------------------------------------------------

df2 <- tibble(x = runif(n = 10, min = 0, max = 1),
              y = rgamma(10, shape = 1,rate = 1),
              z = rnorm(10, mean = 0, sd = 1))
dim(df2)



## ---------------------------------------------------------------------------------------------------------

means_df <- vector(mode = "double", length = ncol(df2))


for (i in seq_along(df2)) {            
  means_df[[i]] <- mean(df2[[i]])      
}

means_df


## ---------------------------------------------------------------------------------------------------------

means_df2 <- apply(df2, MARGIN = 2, FUN = mean)

means_df2

sd(df2$x)
sd(df2$y)
sd(df2$z)

